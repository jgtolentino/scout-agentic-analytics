"use strict";(()=>{var e={};e.id=803,e.ids=[803,888,660],e.modules={4711:(e,r,a)=>{a.r(r),a.d(r,{config:()=>I,default:()=>$,getServerSideProps:()=>H,getStaticPaths:()=>E,getStaticProps:()=>G,reportWebVitals:()=>L,routeModule:()=>Z,unstable_getServerProps:()=>z,unstable_getServerSideProps:()=>O,unstable_getStaticParams:()=>V,unstable_getStaticPaths:()=>U,unstable_getStaticProps:()=>T});var t={};a.r(t),a.d(t,{default:()=>brands});var s=a(8877),i=a(4591),n=a(6021),l=a(1938),o=a.n(l),d=a(8025),c=a(997),x=a(6689),h=a.n(x),m=a(968),u=a.n(m),p=a(9097),g=a.n(p),j=a(8910),b=a(8205),v=a(739),y=a(5484),_=a(5556),f=a(3131),w=a(1154),N=a(171),k=a(8560),q=a(1510),S=a(2411),P=a(5076),C=a(9669),M=a(86),B=a(3891),D=a(5226),A=a(7049),K=a(1544),F=a(8635);let BrandAnalytics=()=>{let[e,r]=(0,x.useState)({categories:void 0}),[a,t]=(0,x.useState)(null),[s,i]=(0,x.useState)("performance"),{data:n,isLoading:l,error:o}=(0,j.useQuery)({queryKey:["scout-brand-analytics",e],queryFn:async()=>{let r=new URLSearchParams({type:"brands"});e.categories?.length&&r.append("categories",e.categories.join(","));let a=await fetch(`/api/scout/analytics?${r}`);if(!a.ok)throw Error("Failed to fetch brand analytics");return a.json()},refetchInterval:6e5,staleTime:48e4}),d=h().useMemo(()=>{if(!n?.data)return null;let e=n.data,r=e.reduce((e,r)=>{let a=r.brand_tier||"Unknown";return e[a]||(e[a]={tier:a,count:0,total_crp:0,avg_market_share:0}),e[a].count++,e[a].total_crp+=r.consumer_reach_points||0,e[a].avg_market_share+=r.market_share_percent||0,e},{}),t=Object.values(r).map(e=>({...e,avg_market_share:e.avg_market_share/e.count})),s=e.map(e=>({brand_name:e.brand_name,market_share:e.market_share_percent||0,price_index:100*(e.vs_category_avg||1),consumer_reach_points:e.consumer_reach_points||0,brand_tier:e.brand_tier,growth_status:e.growth_status})),i=e.filter(e=>e.market_share_percent&&e.market_share_percent>1).map(e=>({brand_name:e.brand_name,market_share:e.market_share_percent||0,consumer_reach_points:e.consumer_reach_points||0,avg_price:e.avg_price_php||0,price_positioning:e.value_proposition,growth_rate:e.brand_growth_yoy||0,competitive_status:e.position_type||"unknown"})),l=a?(()=>{let r=e.find(e=>e.brand_name===a);return r?[{metric:"Market Share",value:Math.min(4*(r.market_share_percent||0),100),fullMark:100},{metric:"CRP",value:Math.min((r.consumer_reach_points||0)/10,100),fullMark:100},{metric:"Price Competitiveness",value:Math.max(0,100-Math.abs(((r.vs_category_avg||1)-1)*100)),fullMark:100},{metric:"Growth",value:Math.min(Math.max(10*(r.brand_growth_yoy||0)+50,0),100),fullMark:100},{metric:"Channel Presence",value:Math.min(12.5*(r.channels_available||0),100),fullMark:100}]:[]})():[];return{tiers:t,positioning:s,competitive:i,radar:l,brands:e}},[n,a]);if(l)return c.jsx("div",{className:"flex items-center justify-center h-96",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-scout-primary"})});if(o)return(0,c.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[c.jsx("h3",{className:"text-red-800 font-medium",children:"Error Loading Brand Analytics"}),c.jsx("p",{className:"text-red-600 text-sm mt-1",children:o instanceof Error?o.message:"Unknown error occurred"})]});let m=d?.brands?.sort((e,r)=>(r.consumer_reach_points||0)-(e.consumer_reach_points||0))?.slice(0,5)||[],u=d?.brands?.filter(e=>void 0!==e.brand_growth_yoy)?.sort((e,r)=>(r.brand_growth_yoy||0)-(e.brand_growth_yoy||0))?.slice(0,5)||[];return(0,c.jsxs)("div",{className:"space-y-6",children:[c.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,c.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,c.jsxs)("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Brand Analytics"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Market positioning, competitive intelligence, and brand performance insights"})]}),c.jsx("div",{className:"flex items-center space-x-4 mt-4 sm:mt-0",children:(0,c.jsxs)("select",{value:e.categories?.[0]||"",onChange:a=>r({...e,categories:a.target.value?[a.target.value]:void 0}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"All Categories"}),c.jsx("option",{value:"Beverages",children:"Beverages"}),c.jsx("option",{value:"Snacks",children:"Snacks"}),c.jsx("option",{value:"Personal Care",children:"Personal Care"}),c.jsx("option",{value:"Household",children:"Household"})]})})]})}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[c.jsx(MetricCard,{title:"Total Brands",value:d?.brands?.length?.toString()||"0",subtitle:"Active brands tracked",icon:c.jsx(D.Z,{className:"w-5 h-5"}),color:"bg-blue-50 text-blue-600"}),c.jsx(MetricCard,{title:"Market Leaders",value:d?.brands?.filter(e=>"leader"===e.position_type)?.length?.toString()||"0",subtitle:"Leading market position",icon:c.jsx(A.Z,{className:"w-5 h-5"}),color:"bg-green-50 text-green-600"}),c.jsx(MetricCard,{title:"Avg. Market Share",value:`${Math.round((d?.brands?.reduce((e,r)=>e+(r.market_share_percent||0),0)||0)/Math.max(d?.brands?.length||1,1))}%`,subtitle:"Average across all brands",icon:c.jsx(K.Z,{className:"w-5 h-5"}),color:"bg-yellow-50 text-yellow-600"}),c.jsx(MetricCard,{title:"High Growth",value:d?.brands?.filter(e=>"High Growth"===e.growth_status)?.length?.toString()||"0",subtitle:"Fast-growing brands",icon:c.jsx(F.Z,{className:"w-5 h-5"}),color:"bg-purple-50 text-purple-600"})]}),c.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:c.jsx("div",{className:"flex space-x-4",children:[{key:"performance",label:"Performance Overview"},{key:"competitive",label:"Competitive Analysis"},{key:"pricing",label:"Pricing Intelligence"}].map(e=>c.jsx("button",{onClick:()=>i(e.key),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${s===e.key?"bg-scout-primary text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:e.label},e.key))})}),d&&(0,c.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:["performance"===s&&(0,c.jsxs)(c.Fragment,{children:[c.jsx(ChartCard,{title:"Brand Tier Distribution",subtitle:"Brands by performance tier",children:c.jsx(b.h,{width:"100%",height:300,children:(0,c.jsxs)(v.v,{data:d.tiers,children:[c.jsx(y.q,{strokeDasharray:"3 3"}),c.jsx(_.K,{dataKey:"tier",angle:-45,textAnchor:"end",height:100,interval:0,fontSize:12}),c.jsx(f.B,{}),c.jsx(w.u,{}),c.jsx(N.$,{dataKey:"count",fill:"#0066CC",name:"Brand Count"})]})})}),c.jsx(ChartCard,{title:"Top Brand Performance",subtitle:"By Consumer Reach Points (CRP)",children:c.jsx(b.h,{width:"100%",height:300,children:(0,c.jsxs)(v.v,{data:m,children:[c.jsx(y.q,{strokeDasharray:"3 3"}),c.jsx(_.K,{dataKey:"brand_name",angle:-45,textAnchor:"end",height:100,interval:0,fontSize:12}),c.jsx(f.B,{}),c.jsx(w.u,{}),c.jsx(N.$,{dataKey:"consumer_reach_points",fill:"#4ECDC4",name:"CRP"})]})})})]}),"competitive"===s&&(0,c.jsxs)(c.Fragment,{children:[c.jsx(ChartCard,{title:"Market Positioning Matrix",subtitle:"Price vs Market Share",children:c.jsx(b.h,{width:"100%",height:300,children:(0,c.jsxs)(k.G,{data:d.positioning,children:[c.jsx(y.q,{strokeDasharray:"3 3"}),c.jsx(_.K,{dataKey:"market_share",name:"Market Share (%)",domain:["dataMin","dataMax"]}),c.jsx(f.B,{dataKey:"price_index",name:"Price Index (%)",domain:["dataMin","dataMax"]}),c.jsx(w.u,{formatter:(e,r)=>[`${Number(e).toFixed(1)}%`,r],labelFormatter:e=>`Brand: ${e}`}),c.jsx(q.b,{dataKey:"price_index",fill:"#FF6B35",name:"Brands"})]})})}),c.jsx(ChartCard,{title:"Fastest Growing Brands",subtitle:"Year-over-year growth rate",children:c.jsx(b.h,{width:"100%",height:300,children:(0,c.jsxs)(v.v,{data:u,children:[c.jsx(y.q,{strokeDasharray:"3 3"}),c.jsx(_.K,{dataKey:"brand_name",angle:-45,textAnchor:"end",height:100,interval:0,fontSize:12}),c.jsx(f.B,{}),c.jsx(w.u,{formatter:e=>[`${Number(e).toFixed(1)}%`,"Growth Rate"]}),c.jsx(N.$,{dataKey:"brand_growth_yoy",fill:"#96CEB4",name:"YoY Growth %"})]})})})]}),"pricing"===s&&(0,c.jsxs)(c.Fragment,{children:[c.jsx(ChartCard,{title:"Price vs Market Share",subtitle:"Pricing strategy analysis",children:c.jsx(b.h,{width:"100%",height:300,children:(0,c.jsxs)(k.G,{data:d.competitive,children:[c.jsx(y.q,{strokeDasharray:"3 3"}),c.jsx(_.K,{dataKey:"market_share",name:"Market Share (%)"}),c.jsx(f.B,{dataKey:"avg_price",name:"Avg Price (₱)"}),c.jsx(w.u,{formatter:(e,r)=>["Avg Price (₱)"===r?`₱${Number(e).toFixed(2)}`:`${Number(e).toFixed(1)}%`,r]}),c.jsx(q.b,{dataKey:"avg_price",fill:"#45B7D1"})]})})}),c.jsx(ChartCard,{title:"Value Proposition Distribution",subtitle:"Brands by pricing strategy",children:c.jsx(b.h,{width:"100%",height:300,children:(0,c.jsxs)(v.v,{data:[{proposition:"Premium",count:d.brands.filter(e=>"Premium"===e.value_proposition).length},{proposition:"Mainstream",count:d.brands.filter(e=>"Mainstream"===e.value_proposition).length},{proposition:"Value",count:d.brands.filter(e=>"Value"===e.value_proposition).length}],children:[c.jsx(y.q,{strokeDasharray:"3 3"}),c.jsx(_.K,{dataKey:"proposition"}),c.jsx(f.B,{}),c.jsx(w.u,{}),c.jsx(N.$,{dataKey:"count",fill:"#FFEAA7",name:"Brand Count"})]})})})]})]}),d&&(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Brand Deep Dive"}),c.jsx("div",{className:"mb-4",children:(0,c.jsxs)("select",{value:a||"",onChange:e=>t(e.target.value||null),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select a brand for detailed analysis"}),d.brands.map(e=>c.jsx("option",{value:e.brand_name,children:e.brand_name},e.brand_name))]})}),a&&d.radar.length>0&&(0,c.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,c.jsxs)("div",{children:[c.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Brand Health Score"}),c.jsx(b.h,{width:"100%",height:300,children:(0,c.jsxs)(S.H,{data:d.radar,children:[c.jsx(P.n,{}),c.jsx(C.I,{dataKey:"metric",fontSize:12}),c.jsx(M.S,{angle:90,domain:[0,100],fontSize:10}),c.jsx(B.F,{name:a,dataKey:"value",stroke:"#0066CC",fill:"#0066CC",fillOpacity:.2,strokeWidth:2}),c.jsx(w.u,{})]})})]}),(0,c.jsxs)("div",{children:[c.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Brand Details"}),(()=>{let e=d.brands.find(e=>e.brand_name===a);return e?(0,c.jsxs)("div",{className:"space-y-3",children:[c.jsx(DetailRow,{label:"Market Share",value:`${e.market_share_percent?.toFixed(1)||0}%`}),c.jsx(DetailRow,{label:"Consumer Reach Points",value:e.consumer_reach_points?.toLocaleString()||"0"}),c.jsx(DetailRow,{label:"Average Price",value:`₱${e.avg_price_php?.toFixed(2)||"0"}`}),c.jsx(DetailRow,{label:"Brand Tier",value:e.brand_tier||"Unknown"}),c.jsx(DetailRow,{label:"Value Proposition",value:e.value_proposition||"Unknown"}),c.jsx(DetailRow,{label:"Growth Status",value:e.growth_status||"Unknown"}),c.jsx(DetailRow,{label:"Competitive Status",value:e.position_type||"Unknown"}),c.jsx(DetailRow,{label:"Channels Available",value:e.channels_available?.toString()||"0"})]}):null})()]})]})]})]})},MetricCard=({title:e,value:r,subtitle:a,icon:t,color:s})=>c.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600",children:e}),c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a})]}),c.jsx("div",{className:`p-3 rounded-lg ${s}`,children:t})]})}),ChartCard=({title:e,subtitle:r,children:a})=>(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,c.jsxs)("div",{className:"mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e}),r&&c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r})]}),a]}),DetailRow=({label:e,value:r})=>(0,c.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0",children:[c.jsx("span",{className:"text-sm text-gray-600",children:e}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:r})]});var R=a(7609);let brands=()=>(0,c.jsxs)(R.Z,{requiredPermissions:["scout_read","analytics_advanced"],children:[(0,c.jsxs)(u(),{children:[c.jsx("title",{children:"Brand Analytics - Scout v7 Dashboard"}),c.jsx("meta",{name:"description",content:"Brand performance and competitive intelligence analytics"}),c.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),c.jsx("link",{rel:"icon",href:"/favicon.ico"})]}),(0,c.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,c.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,c.jsxs)("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(g(),{href:"/",children:c.jsx("h1",{className:"text-xl font-bold text-scout-primary cursor-pointer",children:"Scout v7"})})}),(0,c.jsxs)("nav",{className:"hidden md:ml-8 md:flex md:space-x-8",children:[c.jsx(g(),{href:"/",className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"Overview"}),c.jsx(g(),{href:"/brands",className:"text-gray-900 hover:text-scout-primary px-3 py-2 rounded-md text-sm font-medium",children:"Brand Analytics"}),c.jsx(g(),{href:"/stores",className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"Store Performance"}),c.jsx(g(),{href:"/insights",className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"AI Insights"})]})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString("en-PH",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),c.jsx("span",{className:"text-xs text-gray-600",children:"Live"})]})]})]})})}),c.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsx(BrandAnalytics,{})}),c.jsx("footer",{className:"bg-white border-t border-gray-200 mt-16",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,c.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"text-sm text-gray-500",children:"\xa9 2025 TBWA Data Intelligence Team"}),c.jsx("div",{className:"text-sm text-gray-400",children:"|"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Scout v7 Analytics Platform"})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-6 mt-4 md:mt-0",children:[c.jsx("a",{href:"/api/scout/analytics",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-500 hover:text-gray-700",children:"API Documentation"}),c.jsx("a",{href:"https://github.com/tbwa/scout-v7",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-500 hover:text-gray-700",children:"GitHub"}),c.jsx("div",{className:"text-sm text-gray-400",children:"v1.0.0"})]})]})})})]})]}),$=(0,n.l)(t,"default"),G=(0,n.l)(t,"getStaticProps"),E=(0,n.l)(t,"getStaticPaths"),H=(0,n.l)(t,"getServerSideProps"),I=(0,n.l)(t,"config"),L=(0,n.l)(t,"reportWebVitals"),T=(0,n.l)(t,"unstable_getStaticProps"),U=(0,n.l)(t,"unstable_getStaticPaths"),V=(0,n.l)(t,"unstable_getStaticParams"),z=(0,n.l)(t,"unstable_getServerProps"),O=(0,n.l)(t,"unstable_getServerSideProps"),Z=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/brands",pathname:"/brands",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:t})},8910:e=>{e.exports=require("@tanstack/react-query")},8103:e=>{e.exports=require("clsx")},5502:e=>{e.exports=require("eventemitter3")},8759:e=>{e.exports=require("lodash/every")},6918:e=>{e.exports=require("lodash/find")},2265:e=>{e.exports=require("lodash/first")},8190:e=>{e.exports=require("lodash/flatMap")},1712:e=>{e.exports=require("lodash/get")},2327:e=>{e.exports=require("lodash/isBoolean")},113:e=>{e.exports=require("lodash/isEqual")},5716:e=>{e.exports=require("lodash/isFunction")},8843:e=>{e.exports=require("lodash/isNaN")},6069:e=>{e.exports=require("lodash/isNil")},7078:e=>{e.exports=require("lodash/isNumber")},5795:e=>{e.exports=require("lodash/isObject")},5452:e=>{e.exports=require("lodash/isPlainObject")},7026:e=>{e.exports=require("lodash/isString")},3824:e=>{e.exports=require("lodash/last")},9941:e=>{e.exports=require("lodash/mapValues")},6625:e=>{e.exports=require("lodash/max")},1341:e=>{e.exports=require("lodash/maxBy")},541:e=>{e.exports=require("lodash/memoize")},604:e=>{e.exports=require("lodash/min")},9318:e=>{e.exports=require("lodash/minBy")},4042:e=>{e.exports=require("lodash/range")},4129:e=>{e.exports=require("lodash/some")},3672:e=>{e.exports=require("lodash/sortBy")},1381:e=>{e.exports=require("lodash/throttle")},9309:e=>{e.exports=require("lodash/uniqBy")},5428:e=>{e.exports=require("lodash/upperFirst")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},1423:e=>{e.exports=require("path")},6689:e=>{e.exports=require("react")},1469:e=>{e.exports=require("react-is")},3522:e=>{e.exports=require("react-smooth")},997:e=>{e.exports=require("react/jsx-runtime")},9540:e=>{e.exports=require("recharts-scale")},8780:e=>{e.exports=require("tiny-invariant")},2470:e=>{e.exports=require("url")},8970:e=>{e.exports=require("victory-vendor/d3-scale")},2725:e=>{e.exports=require("victory-vendor/d3-shape")}};var r=require("../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),a=r.X(0,[938,259,414,391,300,25,609],()=>__webpack_exec__(4711));module.exports=a})();