"use strict";(()=>{var e={};e.id=803,e.ids=[803,888,660],e.modules={8723:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>g,default:()=>h,getServerSideProps:()=>p,getStaticPaths:()=>u,getStaticProps:()=>m,reportWebVitals:()=>j,routeModule:()=>w,unstable_getServerProps:()=>_,unstable_getServerSideProps:()=>f,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>b});var s=a(8877),i=a(4591),n=a(6021),l=a(1938),o=a.n(l),d=a(5479),c=a(6535),x=e([d,c]);[d,c]=x.then?(await x)():x;let h=(0,n.l)(c,"default"),m=(0,n.l)(c,"getStaticProps"),u=(0,n.l)(c,"getStaticPaths"),p=(0,n.l)(c,"getServerSideProps"),g=(0,n.l)(c,"config"),j=(0,n.l)(c,"reportWebVitals"),b=(0,n.l)(c,"unstable_getStaticProps"),v=(0,n.l)(c,"unstable_getStaticPaths"),y=(0,n.l)(c,"unstable_getStaticParams"),_=(0,n.l)(c,"unstable_getServerProps"),f=(0,n.l)(c,"unstable_getServerSideProps"),w=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/brands",pathname:"/brands",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:c});t()}catch(e){t(e)}})},1256:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.d(r,{b:()=>BrandAnalytics});var s=a(997),i=a(6689),n=a.n(i),l=a(9752),o=a(8205),d=a(739),c=a(5484),x=a(5556),h=a(3131),m=a(4377),u=a(4908),p=a(8560),g=a(6197),j=a(2411),b=a(5076),v=a(9669),y=a(86),_=a(3891),f=a(5226),w=a(7049),N=a(1544),k=a(8635),S=e([l,o,d,c,x,h,m,u,p,g,j,b,v,y,_]);[l,o,d,c,x,h,m,u,p,g,j,b,v,y,_]=S.then?(await S)():S;let BrandAnalytics=()=>{let[e,r]=(0,i.useState)({categories:void 0}),[a,t]=(0,i.useState)(null),[S,P]=(0,i.useState)("performance"),{data:q,isLoading:C,error:B}=(0,l.useQuery)({queryKey:["scout-brand-analytics",e],queryFn:async()=>{let r=new URLSearchParams({type:"brands"});e.categories?.length&&r.append("categories",e.categories.join(","));let a=await fetch(`/api/scout/analytics?${r}`);if(!a.ok)throw Error("Failed to fetch brand analytics");return a.json()},refetchInterval:6e5,staleTime:48e4}),M=n().useMemo(()=>{if(!q?.data)return null;let e=q.data,r=e.reduce((e,r)=>{let a=r.brand_tier||"Unknown";return e[a]||(e[a]={tier:a,count:0,total_crp:0,avg_market_share:0}),e[a].count++,e[a].total_crp+=r.consumer_reach_points||0,e[a].avg_market_share+=r.market_share_percent||0,e},{}),t=Object.values(r).map(e=>({...e,avg_market_share:e.avg_market_share/e.count})),s=e.map(e=>({brand_name:e.brand_name,market_share:e.market_share_percent||0,price_index:100*(e.vs_category_avg||1),consumer_reach_points:e.consumer_reach_points||0,brand_tier:e.brand_tier,growth_status:e.growth_status})),i=e.filter(e=>e.market_share_percent&&e.market_share_percent>1).map(e=>({brand_name:e.brand_name,market_share:e.market_share_percent||0,consumer_reach_points:e.consumer_reach_points||0,avg_price:e.avg_price_php||0,price_positioning:e.value_proposition,growth_rate:e.brand_growth_yoy||0,competitive_status:e.position_type||"unknown"})),n=a?(()=>{let r=e.find(e=>e.brand_name===a);return r?[{metric:"Market Share",value:Math.min(4*(r.market_share_percent||0),100),fullMark:100},{metric:"CRP",value:Math.min((r.consumer_reach_points||0)/10,100),fullMark:100},{metric:"Price Competitiveness",value:Math.max(0,100-Math.abs(((r.vs_category_avg||1)-1)*100)),fullMark:100},{metric:"Growth",value:Math.min(Math.max(10*(r.brand_growth_yoy||0)+50,0),100),fullMark:100},{metric:"Channel Presence",value:Math.min(12.5*(r.channels_available||0),100),fullMark:100}]:[]})():[];return{tiers:t,positioning:s,competitive:i,radar:n,brands:e}},[q,a]);if(C)return s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-scout-primary"})});if(B)return(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-red-800 font-medium",children:"Error Loading Brand Analytics"}),s.jsx("p",{className:"text-red-600 text-sm mt-1",children:B instanceof Error?B.message:"Unknown error occurred"})]});let A=M?.brands?.sort((e,r)=>(r.consumer_reach_points||0)-(e.consumer_reach_points||0))?.slice(0,5)||[],D=M?.brands?.filter(e=>void 0!==e.brand_growth_yoy)?.sort((e,r)=>(r.brand_growth_yoy||0)-(e.brand_growth_yoy||0))?.slice(0,5)||[];return(0,s.jsxs)("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Brand Analytics"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Market positioning, competitive intelligence, and brand performance insights"})]}),s.jsx("div",{className:"flex items-center space-x-4 mt-4 sm:mt-0",children:(0,s.jsxs)("select",{value:e.categories?.[0]||"",onChange:a=>r({...e,categories:a.target.value?[a.target.value]:void 0}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[s.jsx("option",{value:"",children:"All Categories"}),s.jsx("option",{value:"Beverages",children:"Beverages"}),s.jsx("option",{value:"Snacks",children:"Snacks"}),s.jsx("option",{value:"Personal Care",children:"Personal Care"}),s.jsx("option",{value:"Household",children:"Household"})]})})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx(MetricCard,{title:"Total Brands",value:M?.brands?.length?.toString()||"0",subtitle:"Active brands tracked",icon:s.jsx(f.Z,{className:"w-5 h-5"}),color:"bg-blue-50 text-blue-600"}),s.jsx(MetricCard,{title:"Market Leaders",value:M?.brands?.filter(e=>"leader"===e.position_type)?.length?.toString()||"0",subtitle:"Leading market position",icon:s.jsx(w.Z,{className:"w-5 h-5"}),color:"bg-green-50 text-green-600"}),s.jsx(MetricCard,{title:"Avg. Market Share",value:`${Math.round((M?.brands?.reduce((e,r)=>e+(r.market_share_percent||0),0)||0)/Math.max(M?.brands?.length||1,1))}%`,subtitle:"Average across all brands",icon:s.jsx(N.Z,{className:"w-5 h-5"}),color:"bg-yellow-50 text-yellow-600"}),s.jsx(MetricCard,{title:"High Growth",value:M?.brands?.filter(e=>"High Growth"===e.growth_status)?.length?.toString()||"0",subtitle:"Fast-growing brands",icon:s.jsx(k.Z,{className:"w-5 h-5"}),color:"bg-purple-50 text-purple-600"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:s.jsx("div",{className:"flex space-x-4",children:[{key:"performance",label:"Performance Overview"},{key:"competitive",label:"Competitive Analysis"},{key:"pricing",label:"Pricing Intelligence"}].map(e=>s.jsx("button",{onClick:()=>P(e.key),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${S===e.key?"bg-scout-primary text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:e.label},e.key))})}),M&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:["performance"===S&&(0,s.jsxs)(s.Fragment,{children:[s.jsx(ChartCard,{title:"Brand Tier Distribution",subtitle:"Brands by performance tier",children:s.jsx(o.h,{width:"100%",height:300,children:(0,s.jsxs)(d.v,{data:M.tiers,children:[s.jsx(c.q,{strokeDasharray:"3 3"}),s.jsx(x.K,{dataKey:"tier",angle:-45,textAnchor:"end",height:100,interval:0,fontSize:12}),s.jsx(h.B,{}),s.jsx(m.u,{}),s.jsx(u.$,{dataKey:"count",fill:"#0066CC",name:"Brand Count"})]})})}),s.jsx(ChartCard,{title:"Top Brand Performance",subtitle:"By Consumer Reach Points (CRP)",children:s.jsx(o.h,{width:"100%",height:300,children:(0,s.jsxs)(d.v,{data:A,children:[s.jsx(c.q,{strokeDasharray:"3 3"}),s.jsx(x.K,{dataKey:"brand_name",angle:-45,textAnchor:"end",height:100,interval:0,fontSize:12}),s.jsx(h.B,{}),s.jsx(m.u,{}),s.jsx(u.$,{dataKey:"consumer_reach_points",fill:"#4ECDC4",name:"CRP"})]})})})]}),"competitive"===S&&(0,s.jsxs)(s.Fragment,{children:[s.jsx(ChartCard,{title:"Market Positioning Matrix",subtitle:"Price vs Market Share",children:s.jsx(o.h,{width:"100%",height:300,children:(0,s.jsxs)(p.G,{data:M.positioning,children:[s.jsx(c.q,{strokeDasharray:"3 3"}),s.jsx(x.K,{dataKey:"market_share",name:"Market Share (%)",domain:["dataMin","dataMax"]}),s.jsx(h.B,{dataKey:"price_index",name:"Price Index (%)",domain:["dataMin","dataMax"]}),s.jsx(m.u,{formatter:(e,r)=>[`${Number(e).toFixed(1)}%`,r],labelFormatter:e=>`Brand: ${e}`}),s.jsx(g.b,{dataKey:"price_index",fill:"#FF6B35",name:"Brands"})]})})}),s.jsx(ChartCard,{title:"Fastest Growing Brands",subtitle:"Year-over-year growth rate",children:s.jsx(o.h,{width:"100%",height:300,children:(0,s.jsxs)(d.v,{data:D,children:[s.jsx(c.q,{strokeDasharray:"3 3"}),s.jsx(x.K,{dataKey:"brand_name",angle:-45,textAnchor:"end",height:100,interval:0,fontSize:12}),s.jsx(h.B,{}),s.jsx(m.u,{formatter:e=>[`${Number(e).toFixed(1)}%`,"Growth Rate"]}),s.jsx(u.$,{dataKey:"brand_growth_yoy",fill:"#96CEB4",name:"YoY Growth %"})]})})})]}),"pricing"===S&&(0,s.jsxs)(s.Fragment,{children:[s.jsx(ChartCard,{title:"Price vs Market Share",subtitle:"Pricing strategy analysis",children:s.jsx(o.h,{width:"100%",height:300,children:(0,s.jsxs)(p.G,{data:M.competitive,children:[s.jsx(c.q,{strokeDasharray:"3 3"}),s.jsx(x.K,{dataKey:"market_share",name:"Market Share (%)"}),s.jsx(h.B,{dataKey:"avg_price",name:"Avg Price (₱)"}),s.jsx(m.u,{formatter:(e,r)=>["Avg Price (₱)"===r?`₱${Number(e).toFixed(2)}`:`${Number(e).toFixed(1)}%`,r]}),s.jsx(g.b,{dataKey:"avg_price",fill:"#45B7D1"})]})})}),s.jsx(ChartCard,{title:"Value Proposition Distribution",subtitle:"Brands by pricing strategy",children:s.jsx(o.h,{width:"100%",height:300,children:(0,s.jsxs)(d.v,{data:[{proposition:"Premium",count:M.brands.filter(e=>"Premium"===e.value_proposition).length},{proposition:"Mainstream",count:M.brands.filter(e=>"Mainstream"===e.value_proposition).length},{proposition:"Value",count:M.brands.filter(e=>"Value"===e.value_proposition).length}],children:[s.jsx(c.q,{strokeDasharray:"3 3"}),s.jsx(x.K,{dataKey:"proposition"}),s.jsx(h.B,{}),s.jsx(m.u,{}),s.jsx(u.$,{dataKey:"count",fill:"#FFEAA7",name:"Brand Count"})]})})})]})]}),M&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Brand Deep Dive"}),s.jsx("div",{className:"mb-4",children:(0,s.jsxs)("select",{value:a||"",onChange:e=>t(e.target.value||null),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[s.jsx("option",{value:"",children:"Select a brand for detailed analysis"}),M.brands.map(e=>s.jsx("option",{value:e.brand_name,children:e.brand_name},e.brand_name))]})}),a&&M.radar.length>0&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Brand Health Score"}),s.jsx(o.h,{width:"100%",height:300,children:(0,s.jsxs)(j.H,{data:M.radar,children:[s.jsx(b.n,{}),s.jsx(v.I,{dataKey:"metric",fontSize:12}),s.jsx(y.S,{angle:90,domain:[0,100],fontSize:10}),s.jsx(_.F,{name:a,dataKey:"value",stroke:"#0066CC",fill:"#0066CC",fillOpacity:.2,strokeWidth:2}),s.jsx(m.u,{})]})})]}),(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Brand Details"}),(()=>{let e=M.brands.find(e=>e.brand_name===a);return e?(0,s.jsxs)("div",{className:"space-y-3",children:[s.jsx(DetailRow,{label:"Market Share",value:`${e.market_share_percent?.toFixed(1)||0}%`}),s.jsx(DetailRow,{label:"Consumer Reach Points",value:e.consumer_reach_points?.toLocaleString()||"0"}),s.jsx(DetailRow,{label:"Average Price",value:`₱${e.avg_price_php?.toFixed(2)||"0"}`}),s.jsx(DetailRow,{label:"Brand Tier",value:e.brand_tier||"Unknown"}),s.jsx(DetailRow,{label:"Value Proposition",value:e.value_proposition||"Unknown"}),s.jsx(DetailRow,{label:"Growth Status",value:e.growth_status||"Unknown"}),s.jsx(DetailRow,{label:"Competitive Status",value:e.position_type||"Unknown"}),s.jsx(DetailRow,{label:"Channels Available",value:e.channels_available?.toString()||"0"})]}):null})()]})]})]})]})},MetricCard=({title:e,value:r,subtitle:a,icon:t,color:i})=>s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:e}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a})]}),s.jsx("div",{className:`p-3 rounded-lg ${i}`,children:t})]})}),ChartCard=({title:e,subtitle:r,children:a})=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e}),r&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r})]}),a]}),DetailRow=({label:e,value:r})=>(0,s.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0",children:[s.jsx("span",{className:"text-sm text-gray-600",children:e}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:r})]});t()}catch(e){t(e)}})},6535:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var s=a(997);a(6689);var i=a(968),n=a.n(i),l=a(9097),o=a.n(l),d=a(1256),c=a(7609),x=e([d]);d=(x.then?(await x)():x)[0];let __WEBPACK_DEFAULT_EXPORT__=()=>(0,s.jsxs)(c.Z,{requiredPermissions:["scout_read","analytics_advanced"],children:[(0,s.jsxs)(n(),{children:[s.jsx("title",{children:"Brand Analytics - Scout v7 Dashboard"}),s.jsx("meta",{name:"description",content:"Brand performance and competitive intelligence analytics"}),s.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),s.jsx("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(o(),{href:"/",children:s.jsx("h1",{className:"text-xl font-bold text-scout-primary cursor-pointer",children:"Scout v7"})})}),(0,s.jsxs)("nav",{className:"hidden md:ml-8 md:flex md:space-x-8",children:[s.jsx(o(),{href:"/",className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"Overview"}),s.jsx(o(),{href:"/brands",className:"text-gray-900 hover:text-scout-primary px-3 py-2 rounded-md text-sm font-medium",children:"Brand Analytics"}),s.jsx(o(),{href:"/stores",className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"Store Performance"}),s.jsx(o(),{href:"/insights",className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"AI Insights"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString("en-PH",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-600",children:"Live"})]})]})]})})}),s.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsx(d.b,{})}),s.jsx("footer",{className:"bg-white border-t border-gray-200 mt-16",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"text-sm text-gray-500",children:"\xa9 2025 TBWA Data Intelligence Team"}),s.jsx("div",{className:"text-sm text-gray-400",children:"|"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Scout v7 Analytics Platform"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-6 mt-4 md:mt-0",children:[s.jsx("a",{href:"/api/scout/analytics",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-500 hover:text-gray-700",children:"API Documentation"}),s.jsx("a",{href:"https://github.com/tbwa/scout-v7",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-500 hover:text-gray-700",children:"GitHub"}),s.jsx("div",{className:"text-sm text-gray-400",children:"v1.0.0"})]})]})})})]})]});t()}catch(e){t(e)}})},5502:e=>{e.exports=require("eventemitter3")},8759:e=>{e.exports=require("lodash/every")},6918:e=>{e.exports=require("lodash/find")},2265:e=>{e.exports=require("lodash/first")},8190:e=>{e.exports=require("lodash/flatMap")},1712:e=>{e.exports=require("lodash/get")},2327:e=>{e.exports=require("lodash/isBoolean")},113:e=>{e.exports=require("lodash/isEqual")},5716:e=>{e.exports=require("lodash/isFunction")},8843:e=>{e.exports=require("lodash/isNaN")},6069:e=>{e.exports=require("lodash/isNil")},7078:e=>{e.exports=require("lodash/isNumber")},5795:e=>{e.exports=require("lodash/isObject")},5452:e=>{e.exports=require("lodash/isPlainObject")},7026:e=>{e.exports=require("lodash/isString")},3824:e=>{e.exports=require("lodash/last")},9941:e=>{e.exports=require("lodash/mapValues")},6625:e=>{e.exports=require("lodash/max")},1341:e=>{e.exports=require("lodash/maxBy")},541:e=>{e.exports=require("lodash/memoize")},604:e=>{e.exports=require("lodash/min")},9318:e=>{e.exports=require("lodash/minBy")},4042:e=>{e.exports=require("lodash/range")},4129:e=>{e.exports=require("lodash/some")},3672:e=>{e.exports=require("lodash/sortBy")},1381:e=>{e.exports=require("lodash/throttle")},9309:e=>{e.exports=require("lodash/uniqBy")},5428:e=>{e.exports=require("lodash/upperFirst")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},1423:e=>{e.exports=require("path")},6689:e=>{e.exports=require("react")},1469:e=>{e.exports=require("react-is")},3522:e=>{e.exports=require("react-smooth")},997:e=>{e.exports=require("react/jsx-runtime")},9540:e=>{e.exports=require("recharts-scale")},2470:e=>{e.exports=require("url")},8970:e=>{e.exports=require("victory-vendor/d3-scale")},2725:e=>{e.exports=require("victory-vendor/d3-shape")},9752:e=>{e.exports=import("@tanstack/react-query")},6593:e=>{e.exports=import("clsx")},4281:e=>{e.exports=import("tiny-invariant")}};var r=require("../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),a=r.X(0,[938,259,414,391,300,479,609],()=>__webpack_exec__(8723));module.exports=a})();